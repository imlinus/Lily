"use strict";var Watcher=function(e,t,i){this.vm=e,this.exp=t,this.cb=i,this.val=this.get()};Watcher.prototype.update=function(){var e=this.val,t=this.vm.data[this.exp];e!==t&&(this.val=t,this.cb.call(this.vm,t))},Watcher.prototype.get=function(){return this.vm.data[this.exp]};var config={silent:!1,symbols:{bind:":",event:"@",loop:"loop",model:"model"}},elementNode=function(e){return 1===e.nodeType},textNode=function(e){return 3===e.nodeType},modelDirective=function(e){return e===config.symbol.model},loopDirective=function(e){return e===config.symbol.loop},eventDirective=function(e){return-1!==e.indexOf(config.symbol.event)},bindDirective=function(e){return e.startsWith(config.symbol.bind)},Compile=function(e,t){this.view=e,this.el=t,this.init()};Compile.prototype.init=function(){this.run=this.view.__proto__,this.run.beforeMount&&this.run.beforeMount(),this.template=this.html(this.view.template),this.compileElement(this.template),this.el&&this.el.appendChild(this.template),this.run.mounted&&this.run.mounted()},Compile.prototype.html=function(e){var t=document.createElement("template");return t.innerHTML=e.trim(),t.content.firstChild},Compile.prototype.compileElement=function(e){for(var t=e.childNodes,i=0;i<t.length;i++){var o=t[i],n=/\{\{(.*)\}\}/,r=o.textContent;elementNode(o)?this.compile(o):textNode(o)&&n.test(r)&&this.compileText(o,n.exec(r)[1].trim()),o.childNodes&&0!==o.childNodes.length&&this.compileElement(o)}},Compile.prototype.compileText=function(e,t){if(this.view.data){var i=this.view.data[t];e.textContent=i,new Watcher(this.view,t,function(t){e.textContent=t||""})}},Compile.prototype.compile=function(e){if(this.view.components){var t=this.view.components[e.localName];if(t){new Compile(t,this.template);this.checkAttrs(e)}}else this.checkAttrs(e)},Compile.prototype.checkAttrs=function(e){for(var t=e.attributes,i=0;i<t.length;i++){var o=t[i];if(modelDirective(o.name)){var n=e.tagName.toLowerCase();console.log("isModelDirective",n,e)}else if(loopDirective(o.name))console.log("isLoopDirective",e);else if(eventDirective(o.name))console.log("isEventDirective",e);else if(bindDirective(o.name)){var r=o.name.substr(1),l=o.nodeValue;console.log("isBindDirective",r,l,e)}}};var welcome=function(e){var t={title:["color: white","font-size: 1.5rem","font-weight: bold","padding: 0.675rem 0 0.475rem"].join(";"),info:["color: white","font-size: 0.75rem","padding: 0"].join(";"),link:["color: white","font-size: 0.75rem","padding: 0.25rem 0 0.675rem"].join(";")};Lily$1.prototype.config.silent||console.log("%c"+"ðŸŒ· Lily.js".trim()+"\n%c"+"More info:".trim()+"\n%c"+"https://github.com/imlinus/lily".trim()+"\n",t.title,t.info,t.link,e)},Lily$1=function(e,t){welcome(this),this.app=new e,this.el=t instanceof HTMLElement?t:t=document.body,this.defineReactive(this.app),new Compile(this.app,this.el),console.log(this)};Lily$1.prototype.defineReactive=function(e){for(var t=0,i=Object.entries(e);t<i.length;t+=1){var o=i[t],n=o[0],r=o[1];if("data"===n)for(var l=0,s=Object.keys(r);l<s.length;l+=1){var c=s[l];this.proxyData(e,c)}else if("components"===n)for(var p=0,a=Object.entries(r);p<a.length;p+=1){var h=a[p];this.defineReactive(h[1])}}},Lily$1.prototype.proxyData=function(e,t){Object.defineProperty(e,t,{configurable:!0,enumerable:!1,get:function(){return e.data[t]},set:function(i){e.data[t]=i}})},Lily$1.prototype.get=function(e){return this.app[e]},Lily$1.prototype.set=function(e,t){this.app[e]=t},Lily$1.prototype.config=config,module.exports=Lily$1;
